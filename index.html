<html>

<head>
	<title>Mapping Past Denver</title>
	<link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet" type="text/css" />
	<link href="https://fonts.googleapis.com/css?family=Montserrat" rel="stylesheet" type="text/css" />
	<link rel="stylesheet" href="./css/nouislider.min.css">
	<link rel="stylesheet" href="./css/leaflet.label.css" />
	<link rel="stylesheet" href="./css/leaflet-sidebar.css">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css" />
	<link rel="stylesheet" href="./css/monokai.css">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
	<link rel="stylesheet" href="./css/guide.css">

	<script src='https://api.tiles.mapbox.com/mapbox.js/v2.2.1/mapbox.js'></script>
  <link href='https://api.tiles.mapbox.com/mapbox.js/v2.2.1/mapbox.css' rel='stylesheet' />


	<script src="https://api.tiles.mapbox.com/mapbox.js/plugins/turf/v2.0.0/turf.min.js"></script>
	<script src="https://code.jquery.com/jquery-2.1.3.js"></script>
	<script src="./js/nouislider.min.js"></script>
	<script src="./js/leaflet.label.js"></script>
	<script src="./js/leaflet-sidebar.js"></script>
	<script src="./js/highlight.pack.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
	<script src="./js/guide.js"></script>

	<link rel="stylesheet" href="./css/style.css">
</head>

<body>
	<div id="sidebar" class="sidebar collapsed">
		<!-- Nav tabs -->
		<ul class="sidebar-tabs" role="tablist">
			<li id="home"><a href="#home" role="tab"><i class="fa fa-info-circle" ></i></a>
			</li>
			<li id="explore"><a href="#explore" role="tab"><i class="fa fa-map"></i></a>
			</li>
			<li id="code"><a href="#code" role="tab"><i class="fa fa-code"></i></a>
			</li>
			<li id="contact"><a href="#contact" role="tab"><i class="fa fa-envelope"></i></a>
			</li>
		</ul>

		<!-- Tab panes -->
		<div class="sidebar-content active">
			<div class="sidebar-pane" id="home">
				<h1>Mapping Past Denver<div class="sidebar-close"><i class="fa fa-times"></i></div></h1>

				<p class="lorem">This project started in the spring of 2015 as an independent study in the geography program at the University of Colorado at Denver under supervision of Mike Hinke. The goal of this project was to explore how to combine different FOSS4G (Free and
					Open Source Software for Geospatial Applications) technologies into a single product that would allow users to explore a spatio-temporal dataset. The theme chosen for this project was the urban past of Denver.</p>

				<p class="lorem">The first step was to define the project's scale, we decided that Denver's Lower Downtown (LoDo) district could offer a clear presentation of the city's urban morphology change through the years. The Denver public library holds and amazing collection
					of Sanborn fire insurance map on its archives, on this project such maps were photographed and then digitized in QGIS. During the digitization process each building had its characteristics translated into attributes such as, number of floors, building
					material, building use, and so on. Denver Public Library only holds copies of 1925 and 1961 Sanborn maps, however, the University of Colorado at Boulder provides digital copies of the 1887 edition of these fire insurance maps. The addition of this
					earlier year allowed us to construct a more complete picture of Denverâ€™s urban evolution from the late nineteenth century to mid twentieth century. To complement the project, we added a 2015 layer with data from Denver Data Catalog so users could compare each historical layer against the most current urban profile. This last layer does not comes if the same level of information as the historical datasets, therefore no extra data can be obtained from this 2015 dataset.
				</p>

				<img src="img/img1.jpg" class="img-circle" width="200" height="200">
				</a>
				<p class="small legend">One of the many original maps used in this project.</p>
			</div>
			<div class="sidebar-pane" id="explore">
				<h1>Explore<div class="sidebar-close"><i class="fa fa-times"></i></div></h1>
				<div class="row">
					<div class="col-md-11" style="margin-bottom:-15">
						<span><h3 class="section" style="margin-left:-13">Year</h3>
						<h3 class="section" style="margin-bottom:23; font-size:20px; margin-left:40px">Layer Transparency</h3></span>
						</div>
						<div class="row">
							<div class="col-md-3">
							<button class="btn btn-default" id="layer1" type="button">
								<span></span> 1887</button>
						</div>
						<div class="col-md-8">
								<div class="noUi-base" id="slider1" ></div>
						</div>
						</div>
						<div class="row">
							<div class="col-md-3">
							<button class="btn btn-default" id="layer2" type="button">
								<span></span> 1925</button>
						</div>
						<div class="col-md-8">
								<div class="noUi-base" id="slider2" ></div>
						</div>
						</div>
						<div class="row">
							<div class="col-md-3">
							<button class="btn btn-default" id="layer3" type="button">
								<span></span> 1961</button>
						</div>
						<div class="col-md-8">
								<div class="noUi-base" id="slider3" ></div>
						</div>
						</div>
						<div class="row">
							<div class="col-md-3">
							<button class="btn btn-default" id="layer4" type="button">
								<span></span> 2015</button>
						</div>
						<div class="col-md-8">
								<div class="noUi-base" id="slider4" ></div>
						</div>
						</div>
					</div>
				<hr>
				<div class="row" style="margin-top:-30">
					<div class="col-md-11">
						<h2 class="section">Building Area</h2>
						<ul>
							<li id="area1"></li>
							<li id="area2"></li>
							<li id="area3"></li>
							<li id="area4"></li>
						</ul>
					</div>
				</div>
				<hr>
				<div class="row" style="margin-top:-30">
					<div class="col-md-11">
						<h2 class="section">Building Count</h2>
						<ul>
							<li id="count1"></li>
							<li id="count2"></li>
							<li id="count3"></li>
							<li id="count4"></li>
						</ul>
					</div>
				</div>
			</div>

			<div class="sidebar-pane" id="code">
				<h1>Behind the Scenes<div class="sidebar-close"><i class="fa fa-times"></i></div></h1>

				<p class="lorem">The main libraries that power this map are:</p>
				<ul>
					<li>
						<a target="_blank" href="http://leafletjs.com/">Leaflet.js</a>
					</li>
					<li>
						<a target="_blank" href="https://jquery.com/">jQuery</a>
					</li>
					<li>
						<a target="_blank" href="http://getbootstrap.com/">Bootstrap</a>
					</li>
					<li>
						<a target="_blank" href="http://turfjs.org/">Turf.js</a>
					</li>
				</ul>

				<p class="lorem">The main driver of this map is leaflet, which does all the heavy lifting to generate the map itself. Once the base map is loaded we can use three different sets of functions to grab and display the historical layers. Everything starts when the user
					clickx on one of the three buttons, which triggers a given function. The mechanisms that allow user interaction with the interface are powered by jQuery. Once the button is clicked a series of jQuery functions change the appearance of the button,
					allow the user to use the opacity slider, display the measurement values, and make a request to load the specific historical layer. To load a historical layer the web-site needs first to grab the raw geoJson, this is made by using an AJAX call through
					the
					<code>.getJSON</code> function, which is a jQuery function. Once the data is gathered a leaflet function draws the layer on the map. After the layer is loaded the script continues to count how many structures are on this specific layer and outputs the
					final number on the interface. The area is calculated on the fly by turf.js, a javascript library that allows for some spatial operations, and the area is then displayed. See below the function that makes the whole process possible.</p>

				<pre>
<code class="js">
//button is clicked to show layer
	$("#layer1").click(function() {
		if ($(this).children().hasClass('glyphicon glyphicon-ok')) {
			map.removeLayer(geojson1);
			slider1.setAttribute('disabled', true); //disable slider when layer is removed
			$('#slider1').css('background-color', '#ccc'); //set slider color to gray
			$('#layer1').css('background', '#26a69e'); //return button to original color
			$('#area1').empty(); //remove area number
			$('#count1').empty(); //remove count number
		} else {
			slider1.removeAttribute('disabled');
			$('#slider1').css('background-color', '#5c97bf'); //set slider color to blue
			$('#layer1').css('background', '#FF9900'); //set button color to match the layer's color
			$.getJSON("data/1887.json", function(data) {
				geojson1 = L.geoJson(data, {
					style: style1,
					onEachFeature: effects
				});
				map.addLayer(geojson1);
				//using turf to calculate area
				var data = geojson1.toGeoJSON(); //needs to translate the layer into geoJson
				var area1 = turf.area(data); //turf function to calculate area
				var area1 = area1.toFixed(2); //round to two decimals
				$('#area1').html('1887: ' + area1 + ' square meters'); //shows the area
				var count1 = data.features.length; //couts the number of objects in data
				$('#count1').html('1887: ' + count1 + ' structures.'); //shows the count
			});
		}
	});
					</code>
				</pre>
			</div>

			<div class="sidebar-pane" id="contact">
				<h1>Contact<div class="sidebar-close"><i class="fa fa-times"></i></div></h1>

				<p class="lorem"><b>Contact me:</b><a href="mailto:ricardo.oliveira@ucdenver.edu"> oliveira.ricardo@hotmail.com</a></p>
				<p class="lorem"><b>See more maps at my<a href="https://github.com/Ricardo-C-Oliveira"> GitHub</a></p>
				<p class="lorem"><b>Ricardo Oliveira</b> <a href="http://ricardooliveiragis.com/"> http://ricardooliveiragis.com/</a></p>
			</div>

		</div>
	</div>


	<div id="map" class="sidebar-map">

		<script>
			//intro js
			$(function() {
				//guide js
				var guide = $("#map").guide();

				guide.addStep("#home", "<b>Welcome to the Mapping Past Denver project!</b><br>On this tab you can get familiarized with the project's background.");
				guide.addStep("#explore", "Click here to access the layer's controls and to get extra spatial information.");
				guide.addStep("#code", "Click here to see how this map works behind the scenes.");
				guide.addStep("#contact", "Do you want to share your feedback? Click here to reach me.");

				guide.start();
				//highlight
				hljs.initHighlightingOnLoad();
				hljs.configure({
					tabReplace: '  '
				})
			});
		</script>
		<script src="script.js"></script>
	</div>
</body>

</html>
